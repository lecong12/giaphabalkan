<!DOCTYPE html>
<html>
<head>
    <script src="https://balkan.app/js/FamilyTree.js"></script>
</head>
<body>
    <div id="tree" style="width:100%; height:100vh;"></div>
    <script>
        async function init() {
            const url = `https://docs.google.com/spreadsheets/d/1mX5C3YiDKb-R1Igweo10NsxCtmxIrG2hlCZM5OlPXEw/gviz/tq?tqx=out:csv&sheet=Data`;
            const response = await fetch(url);
            const text = await response.text();
            const data = FamilyTree.csv.parse(text.replace(/"/g, ""));
            
            const nodes = data.map(p => ({
                id: p.id,
                mid: p.mid,
                fid: p.fid,
                name: p.full_name,
                gender: String(p.gender).toLowerCase().includes('fe') ? 'female' : 'male'
            }));

            new FamilyTree(document.getElementById("tree"), {
                nodes: nodes,
                nodeBinding: { field_0: "name" }
            });
        }
        init();
    </script>
</body>
</html>
