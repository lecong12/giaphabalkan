<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Ki·ªÉm tra GID Gia Ph·∫£</title>
    <script src="https://balkan.app/js/familytree.js"></script>
    <style>
        body { background: #1a1a1a; color: #fff; font-family: sans-serif; }
        #debug-box { padding: 20px; line-height: 1.6; border: 2px solid #444; margin: 20px; border-radius: 8px; }
        .error { color: #ff4d4d; font-weight: bold; }
        .success { color: #00ff00; }
        #tree { width: 100%; height: 500px; }
    </style>
</head>
<body>
    <div id="debug-box">
        <h3>üîç Nh·∫≠t k√Ω Radar D·ªØ li·ªáu:</h3>
        <div id="log-data">ƒêang ki·ªÉm tra Sheet Huy·∫øt th·ªëng (gid=0)...</div>
        <div id="log-partner">ƒêang ki·ªÉm tra Sheet V·ª£/Ch·ªìng (gid=1705210560)...</div>
    </div>
    <div id="tree"></div>

    <script>
        const ssId = '1KgxSyIETIPPO7P_tBUcK7bRO4Ej4b863A-skdMHLMYM';

        async function check() {
            const fetchTest = async (gid, elementId, label) => {
                const el = document.getElementById(elementId);
                try {
                    const r = await fetch(`https://docs.google.com/spreadsheets/d/${ssId}/gviz/tq?tqx=out:json&gid=${gid}`);
                    const t = await r.text();
                    const j = JSON.parse(t.substring(47, t.length - 2));
                    const count = j.table.rows.length;
                    
                    if (count > 0) {
                        el.innerHTML = `<span class="success">‚úÖ ${label} (gid=${gid}): ƒê√£ k·∫øt n·ªëi. T√¨m th·∫•y ${count} h√†ng.</span>`;
                        return j.table.rows;
                    } else {
                        el.innerHTML = `<span class="error">‚ùå ${label} (gid=${gid}): K·∫øt n·ªëi ƒë∆∞·ª£c nh∆∞ng KH√îNG c√≥ d·ªØ li·ªáu!</span>`;
                        return [];
                    }
                } catch (e) {
                    el.innerHTML = `<span class="error">‚ùå ${label} (gid=${gid}): L·ªñI K·∫æT N·ªêI (Sai GID ho·∫∑c ch∆∞a Ph√°t h√†nh web).</span>`;
                    return [];
                }
            };

            const [rows1, rows2] = await Promise.all([
                fetchTest('0', 'log-data', 'Sheet Huy·∫øt th·ªëng'),
                fetchTest('1705210560', 'log-partner', 'Sheet V·ª£/Ch·ªìng')
            ]);

            // N·∫øu c√≥ d·ªØ li·ªáu th√¨ th·ª≠ v·∫Ω node
            if (rows1.length > 0) {
                // (Ph·∫ßn code v·∫Ω FamilyTree gi·ªØ nguy√™n nh∆∞ c≈© ·ªü ƒë√¢y)
                console.log("D·ªØ li·ªáu s·∫µn s√†ng ƒë·ªÉ v·∫Ω.");
            }
        }
        check();
    </script>
</body>
</html>
